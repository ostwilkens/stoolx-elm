<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <script src="elm.js"></script>
  <script src="node_modules/elm-canvas/elm-canvas.js"></script>
</head>

<body>
  <div id="elm"></div>
  <script>
  var storedState = localStorage.getItem('stoolx-save');
  console.log("Retrieved state: ", storedState);
  var startingState = storedState ? JSON.parse(storedState) : null;

  var app = Elm.Main.init({
    node: document.getElementById('elm')
    , flags: startingState
  });

  app.ports.storeNodes.subscribe(function(nodes) {
    if (nodes.length > 0) {
      var nodesJson = JSON.stringify(nodes);
      localStorage.setItem('stoolx-save', nodesJson);
      console.log("Saved state: ", nodesJson);
    }
  });
  </script>
</body>
</html>
